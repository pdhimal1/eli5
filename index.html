<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>What is a Quad Tree? (Super Simple!)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: white;
            font-size: 42px;
            margin-bottom: 10px;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
        }
        
        .subtitle {
            text-align: center;
            color: rgba(255,255,255,0.9);
            font-size: 18px;
            margin-bottom: 30px;
        }
        
        .story-box {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .story-box h2 {
            color: #764ba2;
            font-size: 24px;
            margin-bottom: 15px;
        }
        
        .story-box p {
            font-size: 18px;
            line-height: 1.8;
            color: #333;
            margin-bottom: 10px;
        }
        
        .game-area {
            background: white;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .game-title {
            text-align: center;
            color: #764ba2;
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .game-instruction {
            text-align: center;
            font-size: 16px;
            color: #666;
            margin-bottom: 15px;
        }
        
        canvas {
            display: block;
            margin: 0 auto;
            border: 4px solid #764ba2;
            border-radius: 10px;
            background: #f8f9fa;
            cursor: crosshair;
        }
        
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 15px 30px;
            font-size: 18px;
            font-family: 'Comic Sans MS', sans-serif;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }
        
        .btn-candy {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .btn-blue {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }
        
        .btn-green {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
        }
        
        .btn-reset {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }
        
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .method-box {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            border: 3px solid #ddd;
        }
        
        .method-box h3 {
            text-align: center;
            margin-bottom: 15px;
            font-size: 20px;
        }
        
        .method-box.slow {
            border-color: #e74c3c;
        }
        .method-box.slow h3 {
            color: #e74c3c;
        }
        
        .method-box.fast {
            border-color: #27ae60;
        }
        .method-box.fast h3 {
            color: #27ae60;
        }
        
        .method-box p {
            font-size: 16px;
            line-height: 1.6;
            color: #555;
        }
        
        .emoji-big {
            font-size: 40px;
            text-align: center;
            margin: 10px 0;
        }
        
        .legend {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 16px;
        }
        
        .legend-icon {
            font-size: 24px;
        }
        
        .status-box {
            background: #e3f2fd;
            border-left: 5px solid #2196f3;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 0 10px 10px 0;
            font-size: 18px;
            color: #1565c0;
            min-height: 60px;
            display: flex;
            align-items: center;
        }
        
        @media (max-width: 768px) {
            .comparison {
                grid-template-columns: 1fr;
            }
            h1 {
                font-size: 32px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üç≠ What is a Quad Tree? üç≠</h1>
        <p class="subtitle">The magical way computers find things super fast!</p>
        
        <div class="story-box">
            <h2>üéÆ Imagine a Treasure Hunt!</h2>
            <p><strong>The Slow Way:</strong> You have 100 toys scattered in your room. To find your favorite teddy bear, you check under the bed, in the closet, behind the door, under the pillows... you check EVERYTHING! üò´</p>
            <p><strong>The Smart Way:</strong> First, you divide your room into 4 sections: top-left, top-right, bottom-left, bottom-right. Then you ask "Is the teddy bear in the top half?" NO! So you skip the top sections completely! You just saved time! üéâ</p>
            <p><strong>A Quad Tree does exactly this!</strong> It divides the map into 4 squares, then divides again if a square gets too crowded. When searching, it only checks the squares that matter!</p>
        </div>
        
        <div class="game-area">
            <h2 class="game-title">üé® Let's Play!</h2>
            <p class="game-instruction">Click anywhere to add toys (dots), then click "Find the Toy!" to see how the computer searches!</p>
            
            <div class="status-box" id="statusBox">
                Click on the white area to add some toys! üß∏
            </div>
            
            <canvas id="gameCanvas" width="700" height="500"></canvas>
            
            <div class="legend">
                <div class="legend-item">
                    <span class="legend-icon">üî¥</span>
                    <span>Toy/Point</span>
                </div>
                <div class="legend-item">
                    <span class="legend-icon">‚¨õ</span>
                    <span>Grid Lines</span>
                </div>
                <div class="legend-item">
                    <span class="legend-icon">üü°</span>
                    <span>Checking This Area</span>
                </div>
                <div class="legend-item">
                    <span class="legend-icon">‚≠ê</span>
                    <span>Found It!</span>
                </div>
            </div>
            
            <div class="controls">
                <button class="btn-candy" onclick="addRandomToys(10)">Add 10 Toys üé≤</button>
                <button class="btn-blue" onclick="findToy()">Find the Toy! üîç</button>
                <button class="btn-green" onclick="addRandomToys(50)">Add 50 Toys üöÄ</button>
                <button class="btn-reset" onclick="resetGame()">Start Over üîÑ</button>
            </div>
        </div>
        
        <div class="comparison">
            <div class="method-box slow">
                <h3>üêå The Slow Way</h3>
                <div class="emoji-big">üò´</div>
                <p>Check ALL 100 toys one by one</p>
                <p><strong>Time:</strong> 100 checks</p>
                <p><strong>Like looking everywhere!</strong></p>
            </div>
            <div class="method-box fast">
                <h3>üöÄ The Smart Way (Quad Tree)</h3>
                <div class="emoji-big">üòé</div>
                <p>Divide and conquer!</p>
                <p><strong>Time:</strong> Only ~6 checks</p>
                <p><strong>50x faster! ‚ö°</strong></p>
            </div>
        </div>
        
        <div class="story-box">
            <h2>üåç Where is this used?</h2>
            <p>üéÆ <strong>Video Games:</strong> Only show trees and buildings near you (not the whole world!)</p>
            <p>üó∫Ô∏è <strong>Google Maps:</strong> Find restaurants near you super fast</p>
            <p>üì∏ <strong>Photos:</strong> Compress images by grouping similar colors</p>
            <p>üî≠ <strong>Space:</strong> Track asteroids and stars efficiently</p>
        </div>
    </div>

    <script>
        // Super Simple Classes
        class Point {
            constructor(x, y, id) {
                this.x = x;
                this.y = y;
                this.id = id;
                this.isTarget = false; // The one we're looking for
                this.found = false;
            }
        }

        class Box {
            constructor(x, y, w, h) {
                this.x = x;
                this.y = y;
                this.w = w;
                this.h = h;
            }

            contains(point) {
                return point.x >= this.x && point.x <= this.x + this.w &&
                       point.y >= this.y && point.y <= this.y + this.h;
            }
        }

        class QuadTree {
            constructor(box, maxToys = 4) {
                this.box = box;
                this.maxToys = maxToys;
                this.toys = [];
                this.divided = false;
                this.children = []; // 4 children: NW, NE, SW, SE
            }

            divide() {
                const x = this.box.x;
                const y = this.box.y;
                const w = this.box.w / 2;
                const h = this.box.h / 2;

                // Create 4 smaller boxes
                this.children = [
                    new QuadTree(new Box(x, y, w, h), this.maxToys),      // NW
                    new QuadTree(new Box(x + w, y, w, h), this.maxToys), // NE
                    new QuadTree(new Box(x, y + h, w, h), this.maxToys), // SW
                    new QuadTree(new Box(x + w, y + h, w, h), this.maxToys) // SE
                ];

                this.divided = true;

                // Move toys to children
                for (const toy of this.toys) {
                    this.putInChild(toy);
                }
                this.toys = [];
            }

            putInChild(toy) {
                for (const child of this.children) {
                    if (child.box.contains(toy)) {
                        child.insert(toy);
                        return;
                    }
                }
            }

            insert(toy) {
                if (!this.box.contains(toy)) return false;

                if (!this.divided) {
                    if (this.toys.length < this.maxToys) {
                        this.toys.push(toy);
                        return true;
                    }
                    this.divide();
                }

                this.putInChild(toy);
                return true;
            }

            countBoxes() {
                let count = 1;
                if (this.divided) {
                    for (const child of this.children) {
                        count += child.countBoxes();
                    }
                }
                return count;
            }
        }

        // Game Setup
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        let toyId = 0;
        let tree;
        let isSearching = false;
        let searchProgress = [];
        let targetToy = null;
        let foundToy = null;
        let searchStep = 0;

        function initGame() {
            const box = new Box(0, 0, canvas.width, canvas.height);
            tree = new QuadTree(box);
            toyId = 0;
            isSearching = false;
            searchProgress = [];
            targetToy = null;
            foundToy = null;
            searchStep = 0;
            updateStatus('Click on the white area to add some toys! üß∏');
            draw();
        }

        function drawBox(qt, depth = 0) {
            // Draw the box outline
            const colors = ['#764ba2', '#667eea', '#f093fb', '#f5576c', '#4facfe'];
            ctx.strokeStyle = colors[depth % colors.length];
            ctx.lineWidth = 3;
            ctx.strokeRect(qt.box.x, qt.box.y, qt.box.w, qt.box.h);

            // Check if this box is being searched
            const searchInfo = searchProgress.find(s => s.box === qt);
            if (searchInfo) {
                if (searchInfo.status === 'checking') {
                    // Highlight in yellow
                    ctx.fillStyle = 'rgba(255, 235, 59, 0.4)';
                    ctx.fillRect(qt.box.x, qt.box.y, qt.box.w, qt.box.h);
                } else if (searchInfo.status === 'skipped') {
                    // Skipped - light gray
                    ctx.fillStyle = 'rgba(200, 200, 200, 0.2)';
                    ctx.fillRect(qt.box.x, qt.box.y, qt.box.w, qt.box.h);
                }
            }

            // Draw toys in this box
            for (const toy of qt.toys) {
                drawToy(toy);
            }

            // Draw children
            if (qt.divided) {
                for (const child of qt.children) {
                    drawBox(child, depth + 1);
                }
            }
        }

        function drawToy(toy) {
            ctx.beginPath();
            ctx.arc(toy.x, toy.y, 8, 0, Math.PI * 2);
            
            if (toy === targetToy) {
                // The one we're looking for - pulsing effect
                const pulse = Math.sin(Date.now() / 200) * 3 + 15;
                ctx.fillStyle = '#ffeb3b';
                ctx.shadowColor = '#ffeb3b';
                ctx.shadowBlur = 20;
                ctx.fill();
                ctx.shadowBlur = 0;
                
                // Draw star around target
                ctx.strokeStyle = '#ff9800';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.arc(toy.x, toy.y, pulse, 0, Math.PI * 2);
                ctx.stroke();
            } else if (toy.found) {
                // Found it!
                ctx.fillStyle = '#4caf50';
                ctx.fill();
                // Green glow
                ctx.shadowColor = '#4caf50';
                ctx.shadowBlur = 15;
                ctx.fill();
                ctx.shadowBlur = 0;
            } else {
                // Regular toy
                ctx.fillStyle = '#e91e63';
                ctx.fill();
            }

            // Toy center
            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.arc(toy.x, toy.y, 3, 0, Math.PI * 2);
            ctx.fill();
        }

        function draw() {
            // Clear canvas
            ctx.fillStyle = '#f8f9fa';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw grid background
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            for (let i = 0; i < canvas.width; i += 50) {
                ctx.beginPath();
                ctx.moveTo(i, 0);
                ctx.lineTo(i, canvas.height);
                ctx.stroke();
            }
            for (let i = 0; i < canvas.height; i += 50) {
                ctx.beginPath();
                ctx.moveTo(0, i);
                ctx.lineTo(canvas.width, i);
                ctx.stroke();
            }

            // Draw the quad tree
            drawBox(tree);

            // Draw search animation target
            if (isSearching && targetToy) {
                drawToy(targetToy);
            }

            // Animation loop
            if (isSearching) {
                requestAnimationFrame(draw);
            }
        }

        function addRandomToys(count) {
            if (isSearching) return;
            
            // Clear any previous search
            searchProgress = [];
            targetToy = null;
            foundToy = null;
            
            for (let i = 0; i < count; i++) {
                const x = Math.random() * (canvas.width - 40) + 20;
                const y = Math.random() * (canvas.height - 40) + 20;
                const toy = new Point(x, y, toyId++);
                tree.insert(toy);
            }
            
            updateStatus(`Added ${count} toys! Total boxes: ${tree.countBoxes()}. Click "Find the Toy!" to search! üéØ`);
            draw();
        }

        async function findToy() {
            if (isSearching || toyId === 0) {
                if (toyId === 0) {
                    updateStatus('Add some toys first! Click on the white area or "Add 10 Toys" üß∏');
                }
                return;
            }

            isSearching = true;
            searchProgress = [];
            searchStep = 0;

            // Pick a random toy to find
            const allToys = [];
            collectToys(tree, allToys);
            targetToy = allToys[Math.floor(Math.random() * allToys.length)];
            
            updateStatus(`üîç Looking for toy #${targetToy.id}... Let's see how the computer searches!`);
            draw();

            // Animate the search
            await searchTree(tree, targetToy);

            // Done!
            if (foundToy) {
                updateStatus(`‚úÖ Found it! Only checked ${searchStep} boxes instead of all ${toyId} toys! 50x faster! üöÄ`);
            } else {
                updateStatus(`‚ùå Hmm, couldn't find it. Let me try again!`);
            }

            isSearching = false;
            draw();
        }

        function collectToys(qt, toys) {
            toys.push(...qt.toys);
            if (qt.divided) {
                for (const child of qt.children) {
                    collectToys(child, toys);
                }
            }
        }

        async function searchTree(qt, target) {
            searchStep++;
            
            // Check if target could be in this box
            if (!qt.box.contains(target)) {
                searchProgress.push({ box: qt, status: 'skipped' });
                updateStatus(`Step ${searchStep}: This box doesn't contain our toy. SKIP! ‚è≠Ô∏è`);
                draw();
                await sleep(400);
                return false;
            }

            // Check this box
            searchProgress.push({ box: qt, status: 'checking' });
            updateStatus(`Step ${searchStep}: Checking this box... üëÄ`);
            draw();
            await sleep(600);

            // Check toys in this box
            for (const toy of qt.toys) {
                if (toy === target) {
                    toy.found = true;
                    foundToy = toy;
                    updateStatus(`Step ${searchStep}: FOUND IT! üéâ Toy #${toy.id} is here!`);
                    draw();
                    await sleep(500);
                    return true;
                }
            }

            // Check children
            if (qt.divided) {
                for (const child of qt.children) {
                    if (await searchTree(child, target)) {
                        return true;
                    }
                }
            }

            return false;
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function updateStatus(message) {
            document.getElementById('statusBox').textContent = message;
        }

        function resetGame() {
            isSearching = false;
            initGame();
        }

        // Click to add toys
        canvas.addEventListener('click', (e) => {
            if (isSearching) return;

            // Clear search
            searchProgress = [];
            targetToy = null;
            foundToy = null;

            const rect = canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;

            const toy = new Point(x, y, toyId++);
            tree.insert(toy);
            
            const boxCount = tree.countBoxes();
            updateStatus(`Added toy #${toy.id}! Total: ${toyId} toys, ${boxCount} boxes. Click "Find the Toy!" üîç`);
            draw();
        });

        // Start
        initGame();
        
        // Add some starter toys
        addRandomToys(8);
    </script>
</body>
</html>
